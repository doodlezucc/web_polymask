import 'package:web_polymask/math/polygon.dart';
import 'package:web_polymask/math/polygon_state.dart';
import 'package:web_polymask/math/polymath.dart';

import 'test_helpers.dart';

void main() {
  final state = parseState('''
- (positive, 245,475 275,423 230,423 237,410 223,410 230,397 216,397 223,384 209,384 216,371 202,371 209,358 195,358 203,344 188,344 196,330 182,330 189,317 176,317 185,302 171,302 179,288 167,288 175,274 164,274 173,258 162,258 171,243 160,243 169,228 160,228 169,213 160,213 168,199 163,199 171,185 168,185 211,110 219,97 220,99 228,86 231,91 239,77 243,84 252,69 257,77 265,63 271,73 279,58 285,69 294,54 300,65 309,50 316,62 324,47 331,60 340,45 347,57 355,42 362,54 370,40 372,40 379,53 387,40 389,40 395,51 402,40 406,40 412,50 417,40 421,40 426,49 431,40 437,40 442,49 447,40 453,40 457,48 462,40 468,40 473,48 477,40 483,40 488,48 492,40 498,40 504,49 509,40 515,40 520,49 525,40 531,40 536,49 541,40 547,40 552,49 557,40 563,40 568,48 572,40 578,40 583,48 587,40 593,40 598,48 602,40 608,40 613,49 618,40 620,40 627,53 634,41 642,55 648,45 656,59 662,48 670,62 676,51 684,65 690,55 698,69 703,61 711,75 715,69 724,84 728,77 736,92 739,87 747,101 748,99 791,174 805,200 804,200 811,213 808,213 817,228 813,228 821,242 817,242 825,256 821,256 829,270 824,270 832,284 825,284 834,300 826,300 835,316 827,316 836,332 826,332 836,350 827,350 836,365 823,365 836,387 823,387 834,406 821,406 830,422 817,422 826,437 813,437 821,451 807,451 814,464 799,464 806,477 790,477 797,489 779,489 786,501 766,501 773,514 753,514 760,526 739,526 745,537 724,537 730,547 705,547 711,557 687,557 692,565 660,565 666,576 640,576 643,581 617,581 618,583 474,583 477,577 431,577 440,561 386,561 398,540 339,540 349,522 309,522 316,510 284,510 291,497 266,497 272,487 255,487 262,475)
  - (negative, 414,462 404,480 373,426 369,433 351,401 336,426 311,382 302,397 281,358 273,344 274,344 266,330 268,330 261,317 262,317 253,302 257,302 249,288 253,288 245,274 250,274 241,258 248,258 239,243 246,243 237,228 246,228 237,213 246,213 238,199 249,199 241,185 254,185 247,172 262,172 256,161 271,161 266,152 282,152 277,144 295,144 292,138 308,138 305,133 322,133 320,129 337,129 335,125 352,125 350,122 367,122 366,120 383,120 381,117 398,117 396,114 414,114 413,113 431,113 430,111 462,111 461,110 493,110 492,109 563,109 562,110 578,110 576,113 593,113 591,116 607,116 605,120 621,120 619,123 635,123 633,126 649,126 647,130 663,130 660,136 677,136 672,144 690,144 685,152 702,152 696,162 712,162 705,174 719,174 712,187 726,187 719,200 732,200 725,213 740,213 731,228 743,228 735,242 747,242 739,256 751,256 743,270 754,270 746,284 757,284 748,300 758,300 749,316 759,316 750,332 760,332 750,350 759,350 750,365 763,365 750,387 759,387 748,406 753,406 744,422 749,422 745,429 743,426 733,444 730,439 720,456 717,451 706,470 702,462 692,480 687,472 675,494 668,482 656,503 649,490 633,518 623,501 610,524 600,506 587,529 575,508 561,532 547,508 532,534 517,508 497,543 474,502 456,533 429,486 428,487)
    - (positive, 362,348 368,338 355,338 363,324 352,324 360,310 348,310 357,295 345,295 354,280 345,280 353,266 349,266 392,191 393,193 401,179 404,185 413,170 417,178 426,163 432,173 440,158 446,168 454,154 461,166 469,152 477,165 484,152 492,165 499,152 507,166 513,155 521,170 527,160 535,174 540,166 548,180 553,172 561,186 564,181 572,195 575,190 584,205 586,201 594,214 595,212 603,226 605,223 613,236 614,234 622,248 623,246 666,321 665,321 672,334 667,334 675,348 666,348 675,363 665,363 674,378 661,378 668,391 654,391 661,404 645,404 651,415 633,415 638,423 621,423 624,429 608,429 610,432 594,432 596,435 580,435 581,436 435,436 437,433 421,433 424,427 408,427 411,421 395,421 400,413 383,413 388,404 372,404 379,392 364,392 372,378 361,378 370,363 360,363 366,352 360,352)
      - (negative, 596,351 598,348 595,348)
      - (negative, 456,357 459,357 432,310 434,310 425,295 431,295 422,280 431,280 423,266 435,266 428,254 444,254 439,245 456,245 452,238 469,238 466,233 483,233 482,230 487,230 484,235 500,235 497,241 513,241 510,247 526,247 521,256 537,256 532,265 549,265 543,276 558,276 552,287 568,287 562,298 577,298 571,309 587,309 580,321 593,321 586,334 597,334 589,348 595,348 586,363 581,354 573,368 567,357 559,371 553,360 545,374 538,361 531,374 523,361 516,374 508,361 501,374 493,361 486,374 478,361 472,372 464,358 460,364)
''');

  final polygon = Polygon(points: parse('428,309 471,384 385,384'));

  final pstate = PolygonState.assignParents(state);
  final merger = PolygonMerger();
  merger.mergePolygon(pstate, polygon);
  print(pstate);
  print(pstate.isValid());
}
